<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter Amerkhanian">
<meta name="dcterms.date" content="2024-06-15">

<title>Some Time Serfor matplotlib</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../profile.jpg" rel="icon" type="image/jpeg">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-V95HGLKTEB"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-V95HGLKTEB', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../profile.jpg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Home</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Some Time Serfor <code>matplotlib</code></h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Peter Amerkhanian </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 15, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div id="cell-1" class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> ctx</span></code></pre></div>
</div>
<div id="cell-2" class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df_stations <span class="op">=</span> df.groupby([<span class="st">'Date'</span>, <span class="st">'End'</span>])[<span class="st">'Riders'</span>].<span class="bu">sum</span>().compute()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_stations <span class="op">=</span> df_stations.reset_index()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df_stations.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">End</th>
<th data-quarto-table-cell-role="th">Riders</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2011-01-01</td>
<td>12TH</td>
<td>2589</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2011-01-01</td>
<td>16TH</td>
<td>4490</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2011-01-01</td>
<td>19TH</td>
<td>2157</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011-01-01</td>
<td>24TH</td>
<td>5212</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2011-01-01</td>
<td>ASHB</td>
<td>2155</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>station_name_crosswalk <span class="op">=</span> pd.read_csv(<span class="st">"station_names.csv"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>station_name_crosswalk[<span class="st">'Abbr'</span>] <span class="op">=</span> station_name_crosswalk[<span class="st">'Abbr'</span>].<span class="bu">str</span>.upper()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>station_name_crosswalk.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Abbr</th>
<th data-quarto-table-cell-role="th">Station Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>12TH</td>
<td>12th St. Oakland City Center</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>16TH</td>
<td>16th St. Mission (SF)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>19TH</td>
<td>19th St. Oakland</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>24TH</td>
<td>24th St. Mission (SF)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ASHB</td>
<td>Ashby (Berkeley)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-4" class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df_stations_merge <span class="op">=</span> df_stations.merge(station_name_crosswalk, left_on<span class="op">=</span><span class="st">'End'</span>, right_on<span class="op">=</span><span class="st">'Abbr'</span>, how<span class="op">=</span><span class="st">"left"</span>).drop(columns<span class="op">=</span>[<span class="st">'Abbr'</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df_stations_merge.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Date</th>
<th data-quarto-table-cell-role="th">End</th>
<th data-quarto-table-cell-role="th">Riders</th>
<th data-quarto-table-cell-role="th">Station Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2011-01-01</td>
<td>12TH</td>
<td>2589</td>
<td>12th St. Oakland City Center</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2011-01-01</td>
<td>16TH</td>
<td>4490</td>
<td>16th St. Mission (SF)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2011-01-01</td>
<td>19TH</td>
<td>2157</td>
<td>19th St. Oakland</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2011-01-01</td>
<td>24TH</td>
<td>5212</td>
<td>24th St. Mission (SF)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2011-01-01</td>
<td>ASHB</td>
<td>2155</td>
<td>Ashby (Berkeley)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stations <span class="op">=</span> gpd.read_file(<span class="st">"California_Rail_Stations.geojson"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>bart_stations <span class="op">=</span> stations[stations[<span class="st">'COMM_OP'</span>] <span class="op">==</span> <span class="st">"BART"</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>bart_stations.head()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">LOCATION</th>
<th data-quarto-table-cell-role="th">STATION</th>
<th data-quarto-table-cell-role="th">CODE</th>
<th data-quarto-table-cell-role="th">ADDRESS</th>
<th data-quarto-table-cell-role="th">ZIP</th>
<th data-quarto-table-cell-role="th">PASS_OP</th>
<th data-quarto-table-cell-role="th">PASS_NETWO</th>
<th data-quarto-table-cell-role="th">COMM_OP</th>
<th data-quarto-table-cell-role="th">COMM_NETWO</th>
<th data-quarto-table-cell-role="th">BUS_ROUTES</th>
<th data-quarto-table-cell-role="th">TRANSIT</th>
<th data-quarto-table-cell-role="th">AIRPORT</th>
<th data-quarto-table-cell-role="th">STATION_TY</th>
<th data-quarto-table-cell-role="th">INTERMODAL</th>
<th data-quarto-table-cell-role="th">DIST</th>
<th data-quarto-table-cell-role="th">CO</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">52</td>
<td>53</td>
<td>BART Station</td>
<td>DUBLIN/PLEASANTON</td>
<td>DBP</td>
<td>I-580 at Hopyard (Mid-Day Parking)</td>
<td>94588</td>
<td></td>
<td></td>
<td>BART</td>
<td>BART</td>
<td>6,34</td>
<td></td>
<td></td>
<td>3</td>
<td>1</td>
<td>4</td>
<td>ALA</td>
<td>POINT (-121.89849 37.70247)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">212</td>
<td>213</td>
<td></td>
<td>NORTH BERKELEY</td>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td></td>
<td>BART</td>
<td>BART</td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>ALA</td>
<td>POINT (-122.28335 37.87406)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">213</td>
<td>214</td>
<td></td>
<td>DOWNTOWN BERKELEY</td>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td></td>
<td>BART</td>
<td>BART</td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>ALA</td>
<td>POINT (-122.26825 37.86969)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">214</td>
<td>215</td>
<td></td>
<td>ASHBY</td>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td></td>
<td>BART</td>
<td>BART</td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>ALA</td>
<td>POINT (-122.27012 37.85321)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>216</td>
<td></td>
<td>ROCKRIDGE</td>
<td></td>
<td></td>
<td>0</td>
<td></td>
<td></td>
<td>BART</td>
<td>BART</td>
<td></td>
<td></td>
<td></td>
<td>1</td>
<td>0</td>
<td>4</td>
<td>ALA</td>
<td>POINT (-122.25178 37.84451)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rapidfuzz.process <span class="im">import</span> extractOne</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rapidfuzz.distance <span class="im">import</span> Levenshtein, JaroWinkler</span></code></pre></div>
</div>
<div id="cell-7" class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Levenshtein.normalized_distance(<span class="st">"peter"</span>, <span class="st">"peterd"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.16666666666666666</code></pre>
</div>
</div>
<div id="cell-8" class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Levenshtein.normalized_distance(<span class="st">"peter"</span>, <span class="st">"dpeter"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.16666666666666666</code></pre>
</div>
</div>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>JaroWinkler.normalized_distance(<span class="st">"peter"</span>, <span class="st">"dpeter"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.05555555555555547</code></pre>
</div>
</div>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>JaroWinkler.normalized_distance(<span class="st">"peter"</span>, <span class="st">"peterd"</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.033333333333333326</code></pre>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> match_dict(left_series: pd.Series, right_series: pd.Series, scoring<span class="op">=</span>Levenshtein.distance):</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    mapping <span class="op">=</span> pd.Series({</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        index: right_series.unique()[extractOne(index.lower(), right_series.<span class="bu">str</span>.lower().unique(), scorer<span class="op">=</span>scoring)[<span class="op">-</span><span class="dv">1</span>]]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> index <span class="kw">in</span> left_series</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mapping</span></code></pre></div>
</div>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>match_dict(bart_stations[<span class="st">'STATION'</span>], df_stations_merge[<span class="st">'Station Name'</span>], scoring<span class="op">=</span>JaroWinkler.normalized_distance)</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>DUBLIN/PLEASANTON                            Dublin/Pleasanton
NORTH BERKELEY                                  North Berkeley
DOWNTOWN BERKELEY                            Downtown Berkeley
ASHBY                                         Ashby (Berkeley)
ROCKRIDGE                                  Rockridge (Oakland)
MACARTHUR                                  MacArthur (Oakland)
19TH STREET/OAKLAND                           19th St. Oakland
WEST OAKLAND                                      West Oakland
12TH ST/OAKLAND CITY CENTER       12th St. Oakland City Center
LAKE MERRITT                            Lake Merritt (Oakland)
FRUITVALE                                  Fruitvale (Oakland)
COLISEUM/OAKLAND AIRPORT (OAK)                        Coliseum
SAN LEANDRO                                        San Leandro
BAY FAIR                                Bay Fair (San Leandro)
CASTRO VALLEY                                    Castro Valley
HAYWARD                                                Hayward
SOUTH HAYWARD                                    South Hayward
UNION CITY                                          Union City
FREMONT                                                Fremont
PITTSBURG/BAY POINT                        Pittsburg/Bay Point
NORTH CONCORD/MARTINEZ                  North Concord/Martinez
CONCORD                                                Concord
EL CERRITO DEL NORTE                      El Cerrito del Norte
PLEASANT HILL/CONTRA COSTA CEN                   Pleasant Hill
EL CERRITO PLAZA                              El Cerrito Plaza
WALNUT CREEK                                      Walnut Creek
LAFAYETTE                                            Lafayette
ORINDA                                                  Orinda
EMBARCADERO                                   Embarcadero (SF)
MONTGOMERY STREET                          Montgomery St. (SF)
POWELL STREET                                  Powell St. (SF)
CIVIC CENTER/ UN PLAZA                       Civic Center (SF)
16TH STREET &amp; MISSION                    16th St. Mission (SF)
24TH STREET &amp; MISSION                    24th St. Mission (SF)
GLEN PARK                                       Glen Park (SF)
BALBOA PARK                                   Balboa Park (SF)
DALY CITY                                            Daly City
COLMA                                                    Colma
SAN BRUNO                                            San Bruno
SFO INTERNATIONAL AIRPORT          San Francisco Int'l Airport
MILLBRAE                                              Millbrae
SOUTH SAN FRANCISCO                        South San Francisco
WEST DUBLIN/PLEASANTON                             West Dublin
dtype: object</code></pre>
</div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df_stations_merge[<span class="st">'Station Name'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0         12th St. Oakland City Center
1                16th St. Mission (SF)
2                     19th St. Oakland
3                24th St. Mission (SF)
4                     Ashby (Berkeley)
                      ...             
227151                      Union City
227152      Warm Springs/South Fremont
227153                    Walnut Creek
227154                     West Dublin
227155                    West Oakland
Name: Station Name, Length: 227156, dtype: object</code></pre>
</div>
</div>
<div id="cell-14" class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>{index: extractOne(index.lower(), df_stations_merge[<span class="st">'Station Name'</span>].<span class="bu">str</span>.lower().unique(), scorer<span class="op">=</span>JaroWinkler.distance)[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> index <span class="kw">in</span> bart_stations[<span class="st">'STATION'</span>]}</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'DUBLIN/PLEASANTON': ('dublin/pleasanton', 0.0, 15),
 'NORTH BERKELEY': ('north berkeley', 0.0, 26),
 'DOWNTOWN BERKELEY': ('downtown berkeley', 0.0, 13),
 'ASHBY': ('ashby (berkeley)', 0.13749999999999996, 4),
 'ROCKRIDGE': ('rockridge (oakland)', 0.10526315789473684, 34),
 'MACARTHUR': ('macarthur (oakland)', 0.10526315789473684, 23),
 '19TH STREET/OAKLAND': ('19th st. oakland', 0.07763157894736838, 2),
 'WEST OAKLAND': ('west oakland', 0.0, 42),
 '12TH ST/OAKLAND CITY CENTER': ('12th st. oakland city center',
  0.06784696784696786,
  0),
 'LAKE MERRITT': ('lake merritt (oakland)', 0.09090909090909094, 22),
 'FRUITVALE': ('fruitvale (oakland)', 0.10526315789473684, 18),
 'COLISEUM/OAKLAND AIRPORT (OAK)': ('coliseum', 0.14666666666666672, 10),
 'SAN LEANDRO': ('san leandro', 0.0, 35),
 'BAY FAIR': ('bay fair (san leandro)', 0.1272727272727272, 6),
 'CASTRO VALLEY': ('castro valley', 0.0, 7),
 'HAYWARD': ('hayward', 0.0, 20),
 'SOUTH HAYWARD': ('south hayward', 0.0, 38),
 'UNION CITY': ('union city', 0.0, 40),
 'FREMONT': ('fremont', 0.0, 17),
 'PITTSBURG/BAY POINT': ('pittsburg/bay point', 0.0, 30),
 'NORTH CONCORD/MARTINEZ': ('north concord/martinez', 0.0, 27),
 'CONCORD': ('concord', 0.0, 11),
 'EL CERRITO DEL NORTE': ('el cerrito del norte', 0.0, 14),
 'PLEASANT HILL/CONTRA COSTA CEN': ('pleasant hill', 0.11333333333333329, 29),
 'EL CERRITO PLAZA': ('el cerrito plaza', 0.0, 31),
 'WALNUT CREEK': ('walnut creek', 0.0, 41),
 'LAFAYETTE': ('lafayette', 0.0, 21),
 'ORINDA': ('orinda', 0.0, 28),
 'EMBARCADERO': ('embarcadero (sf)', 0.0625, 16),
 'MONTGOMERY STREET': ('montgomery st. (sf)', 0.1102167182662539, 25),
 'POWELL STREET': ('powell st. (sf)', 0.1415384615384616, 32),
 'CIVIC CENTER/ UN PLAZA': ('civic center (sf)', 0.1288770053475936, 8),
 '16TH STREET &amp; MISSION': ('16th st. mission (sf)', 0.1327380952380952, 1),
 '24TH STREET &amp; MISSION': ('24th st. mission (sf)', 0.1327380952380952, 3),
 'GLEN PARK': ('glen park (sf)', 0.0714285714285714, 19),
 'BALBOA PARK': ('balboa park (sf)', 0.0625, 5),
 'DALY CITY': ('daly city', 0.0, 12),
 'COLMA': ('colma', 0.0, 9),
 'SAN BRUNO': ('san bruno', 0.0, 36),
 'SFO INTERNATIONAL AIRPORT': ("san francisco int'l airport",
  0.20064646464646474,
  37),
 'MILLBRAE': ('millbrae', 0.0, 24),
 'SOUTH SAN FRANCISCO': ('south san francisco', 0.0, 39),
 'WEST DUBLIN/PLEASANTON': ('west dublin', 0.09999999999999998, 43)}</code></pre>
</div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.Series({index: extractOne(index.lower(), df_stations_merge[<span class="st">'Station Name'</span>].<span class="bu">str</span>.lower().unique(), scorer<span class="op">=</span>JaroWinkler.distance)[<span class="dv">0</span>] <span class="cf">for</span> index <span class="kw">in</span> bart_stations[<span class="st">'STATION'</span>]})</span></code></pre></div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>test.reset_index() df_stations_merge[<span class="st">'Station Name'</span>].<span class="bu">str</span>.lower()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>DUBLIN/PLEASANTON</td>
<td>dublin/pleasanton</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NORTH BERKELEY</td>
<td>north berkeley</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>DOWNTOWN BERKELEY</td>
<td>downtown berkeley</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>ASHBY</td>
<td>ashby (berkeley)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>ROCKRIDGE</td>
<td>rockridge (oakland)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>MACARTHUR</td>
<td>macarthur (oakland)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>19TH STREET/OAKLAND</td>
<td>19th st. oakland</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>WEST OAKLAND</td>
<td>west oakland</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>12TH ST/OAKLAND CITY CENTER</td>
<td>12th st. oakland city center</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>LAKE MERRITT</td>
<td>lake merritt (oakland)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>FRUITVALE</td>
<td>fruitvale (oakland)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>COLISEUM/OAKLAND AIRPORT (OAK)</td>
<td>coliseum</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>SAN LEANDRO</td>
<td>san leandro</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>BAY FAIR</td>
<td>bay fair (san leandro)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>CASTRO VALLEY</td>
<td>castro valley</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>HAYWARD</td>
<td>hayward</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>SOUTH HAYWARD</td>
<td>south hayward</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>UNION CITY</td>
<td>union city</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>FREMONT</td>
<td>fremont</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>PITTSBURG/BAY POINT</td>
<td>pittsburg/bay point</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>NORTH CONCORD/MARTINEZ</td>
<td>north concord/martinez</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">21</td>
<td>CONCORD</td>
<td>concord</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">22</td>
<td>EL CERRITO DEL NORTE</td>
<td>el cerrito del norte</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23</td>
<td>PLEASANT HILL/CONTRA COSTA CEN</td>
<td>pleasant hill</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24</td>
<td>EL CERRITO PLAZA</td>
<td>el cerrito plaza</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>WALNUT CREEK</td>
<td>walnut creek</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26</td>
<td>LAFAYETTE</td>
<td>lafayette</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27</td>
<td>ORINDA</td>
<td>orinda</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>EMBARCADERO</td>
<td>embarcadero (sf)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">29</td>
<td>MONTGOMERY STREET</td>
<td>montgomery st. (sf)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">30</td>
<td>POWELL STREET</td>
<td>powell st. (sf)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31</td>
<td>CIVIC CENTER/ UN PLAZA</td>
<td>civic center (sf)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32</td>
<td>16TH STREET &amp; MISSION</td>
<td>16th st. mission (sf)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">33</td>
<td>24TH STREET &amp; MISSION</td>
<td>24th st. mission (sf)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34</td>
<td>GLEN PARK</td>
<td>glen park (sf)</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35</td>
<td>BALBOA PARK</td>
<td>balboa park (sf)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">36</td>
<td>DALY CITY</td>
<td>daly city</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37</td>
<td>COLMA</td>
<td>colma</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38</td>
<td>SAN BRUNO</td>
<td>san bruno</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>SFO INTERNATIONAL AIRPORT</td>
<td>san francisco int'l airport</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>MILLBRAE</td>
<td>millbrae</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>SOUTH SAN FRANCISCO</td>
<td>south san francisco</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42</td>
<td>WEST DUBLIN/PLEASANTON</td>
<td>west dublin</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bart_stations[<span class="st">'STATION'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>52                  DUBLIN/PLEASANTON
212                    NORTH BERKELEY
213                 DOWNTOWN BERKELEY
214                             ASHBY
215                         ROCKRIDGE
216                         MACARTHUR
217               19TH STREET/OAKLAND
218                      WEST OAKLAND
219       12TH ST/OAKLAND CITY CENTER
220                      LAKE MERRITT
221                         FRUITVALE
222    COLISEUM/OAKLAND AIRPORT (OAK)
223                       SAN LEANDRO
224                          BAY FAIR
225                     CASTRO VALLEY
226                           HAYWARD
227                     SOUTH HAYWARD
228                        UNION CITY
229                           FREMONT
230               PITTSBURG/BAY POINT
231            NORTH CONCORD/MARTINEZ
232                           CONCORD
233              EL CERRITO DEL NORTE
234    PLEASANT HILL/CONTRA COSTA CEN
235                  EL CERRITO PLAZA
236                      WALNUT CREEK
237                         LAFAYETTE
238                            ORINDA
239                       EMBARCADERO
240                 MONTGOMERY STREET
241                     POWELL STREET
242            CIVIC CENTER/ UN PLAZA
243             16TH STREET &amp; MISSION
244             24TH STREET &amp; MISSION
245                         GLEN PARK
246                       BALBOA PARK
247                         DALY CITY
248                             COLMA
249                         SAN BRUNO
250         SFO INTERNATIONAL AIRPORT
251                          MILLBRAE
252               SOUTH SAN FRANCISCO
253            WEST DUBLIN/PLEASANTON
Name: STATION, dtype: object</code></pre>
</div>
</div>
<div id="cell-18" class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df_stations[<span class="st">'Station Name'</span>].unique()</span></code></pre></div>
<div class="cell-output cell-output-display">
<pre><code>array(['12th St. Oakland City Center', '16th St. Mission (SF)',
       '19th St. Oakland', '24th St. Mission (SF)', 'Ashby (Berkeley)',
       'Balboa Park (SF)', 'Bay Fair (San Leandro)', 'Castro Valley',
       'Civic Center (SF)', 'Colma', 'Coliseum', 'Concord', 'Daly City',
       'Downtown Berkeley', 'El Cerrito del Norte', 'Dublin/Pleasanton',
       'Embarcadero (SF)', 'Fremont', 'Fruitvale (Oakland)',
       'Glen Park (SF)', 'Hayward', 'Lafayette', 'Lake Merritt (Oakland)',
       'MacArthur (Oakland)', 'Millbrae', 'Montgomery St. (SF)',
       'North Berkeley', 'North Concord/Martinez', 'Orinda',
       'Pleasant Hill', 'Pittsburg/Bay Point', 'El Cerrito Plaza',
       'Powell St. (SF)', 'Richmond', 'Rockridge (Oakland)',
       'San Leandro', 'San Bruno', "San Francisco Int'l Airport",
       'South Hayward', 'South San Francisco', 'Union City',
       'Walnut Creek', 'West Oakland', 'West Dublin',
       "Oakland Int'l Airport", 'Warm Springs/South Fremont', 'Antioch',
       'Pittsburg Center', 'Berryessa / North San Jose', 'Milpitas'],
      dtype=object)</code></pre>
</div>
</div>
<div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shapefile of California (replace 'path_to_shapefile' with your file path)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For this example, we'll use a built-in GeoPandas dataset.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> gpd.read_file(gpd.datasets.get_path(<span class="st">'naturalearth_lowres'</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>california <span class="op">=</span> world[world.name <span class="op">==</span> <span class="st">'United States'</span>]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a predefined boundary of the Bay Area (you may need to customize this)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>bay_area_counties <span class="op">=</span> [<span class="st">'San Francisco'</span>, <span class="st">'San Mateo'</span>, <span class="st">'Santa Clara'</span>, <span class="st">'Alameda'</span>, <span class="st">'Contra Costa'</span>, <span class="st">'Solano'</span>, <span class="st">'Napa'</span>, <span class="st">'Sonoma'</span>, <span class="st">'Marin'</span>]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the counties shapefile (you need to have a shapefile of counties)</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>stations <span class="op">=</span> gpd.read_file(<span class="st">"California_Rail_Stations.geojson"</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>bart_stations <span class="op">=</span> stations[stations[<span class="st">'COMM_OP'</span>] <span class="op">==</span> <span class="st">"BART"</span>]</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the Bay Area map</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>))</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>bart_stations.plot(ax<span class="op">=</span>ax, edgecolor<span class="op">=</span><span class="st">'black'</span>, facecolor<span class="op">=</span><span class="st">'lightblue'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>ctx.add_basemap(ax, crs<span class="op">=</span>bart_stations.crs.to_string(), source<span class="op">=</span>ctx.providers.CartoDB.Voyager)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'San Francisco Bay Area Map'</span>, fontsize<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>ax.set_axis_off()<span class="op">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/peter-amerkhanian\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Peter Amerkhanian</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>